<!DOCTYPE html>
<html lang="ko" dir="ltr">

<head>
	<meta charset="utf-8">
	<title>SPARK</title>
	<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
	<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/socket.io/1.4.8/socket.io.min.js" charset="utf-8"></script>

</head>
<style>
	html, body{
        margin: 0;
        padding: 0;
        height: 100%;
    }

    .container{
        padding: 10px;
         max-width: 1300px;
    }

    #header_chat{
        height: 94%;
        margin: 0 auto;
        padding: 0;
    }

    #bottom_container{
        height: 10%;
    }

    #inputbox{
      padding: 0;
      margin: 0 auto;
    }

    .navbar {
      padding: 0 10px;
    }

    header {
      padding: 10px;
      text-align: left;
      font-size: 35px;
      color: white;
      height: 10%;
    }

    .bg-light {
        background-color: #FFFFFF;
    }

    #chat_container{
      height: 90%;
      float:left;
      position:relative;
      width: 80%;
      display:inline-block;
      overflow: auto;
      background: #FFF8DC;
    }

    #side_container {
      float: right;
      width: 20%;
      height: 90%;
      background: #DEB887;
      color: #696969;
      overflow: hidden;
      position: relative;
    }

    #messages {
      padding: 10px;
    }

  	.icon {
  		width : 20px;
  	}

    #mymessage {
      float: right;
    }

    span {
      color: #8B4513;
    }

  </style>

<body>
<<<<<<< HEAD
	<script type="text/javascript" charset='utf-8'>
		$(document).ready(function() {
			var sock = io.connect();
			sock.on('connect', function() {
				var connect_string = 'new_connect';
				sock.send(connect_string);
				var data = document.location.href.split("?")[1];
				var username = data.split("&")[0].split("=")[1];
				var profilecon = data.split("&")[1].split("=")[1];
				console.log(username);
				console.log(profilecon);
			});

  <script type="text/javascript" charset='utf-8'>
    $(document).ready(function() {
      var sock = io.connect();
      sock.on('connect', function() {
        var connect_string = 'new_connect';
        sock.send(connect_string);
        var link = document.location.href.split("?")[1];
        var username = link.split("&")[0].split("=")[1];
        var profilecon = link.split("&")[1].split("=")[1];
        console.log(username);
        console.log(profilecon);
      });

      sock.on('message', function(data) {
        if (data.messages.type === 'normal') {
          var talker = data.messages.user;
          var myname = document.location.href.split("?")[1].split("&")[0].split("=")[1];
					console.log(talker, myname);
          if (talker == myname) {
            $('#messages').append("<span id=mymessage>" + data.messages.message + "   " + "<img class=icon src=http://127.0.0.1:5000/static/" + data.messages.profilecon + ">" + '</span><br>');
          } else {
            $('#messages').append("<span><img class=icon src=http://127.0.0.1:5000/static/" + data.messages.profilecon + ">" + "  " + data.messages.user + "  : " + data.messages.message + '</span><br>');
          }
        } else {
          $('#messages').append("<span><img class=icon src=http://127.0.0.1:5000/static/" + data.messages.profilecon + ">" + data.messages.message + '</span><br>');
        }
        console.log('Received Message : ' + data.messages.type);
        console.log(data);
      });

      sock.on('message', function(data) {
        if (data.messages.type === 'connect') {
          $("p").html("");
          var data_list = data
          for (var user in data_list.current_users) {
            var profilecon = data_list["current_users"][user]["con"]
            var username = data_list["current_users"][user]["name"]
            $('#current_users').append("<img class=icon src=http://127.0.0.1:5000/static/" + profilecon + ">" + '  ' + username + '  ' + '<br>');
          }
        }
      });

      $("#myMessage").keyup(function(event) {
				if (event.keyCode === 13) {
					message = $('#myMessage').val();
					if (message.length !== 0) {
						$("#sendbutton").click();
					}
				}
			});

      $('#sendbutton').on('click', function() {
				message = $('#myMessage').val();
				sock.send(escape(message));
				$('#myMessage').val('');
			});

      setInterval(function() {
        var chat_scroll = document.getElementById('chat_container');
        chat_scroll.scrollTop = chat_scroll.scrollHeight; }, 100)
    });
  </script>

  <div class="container" id="header_chat">
    <img src=http://127.0.0.1:5000/static/logo_long.jpg width=300 height=80>

    <div class="container" id="chat_container">
      <ul id="messages"></ul>
    </div>

    <div class="container" id="side_container">
        <h6>Current Users</h6>
        <p id="current_users"></p>
    </div>
  </div>

  </div>
  <div class="container input-group mb-3" id="inputbox">
    <input id='myMessage' type="text" class="form-control" placeholder="Enter the Message" aria-label="Recipient's username" aria-describedby="button-addon2">
    <div class="input-group-append">
      <button class="btn btn-outline-secondary" type="button" id="sendbutton">Send</button>
    </div>
  </div>


</body>

</html>
